<% provide(:title, 'Partner With Us') %>

<div id="partner">
<div id="section-name" data-name="partner">

<div class="page-header">
  <div class="row">
    <div class="col-md-6">
      <h1>Partner With Us</h1>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-xs-12 col-md-4">

    <i class="fa fa-spinner fa-pulse fa-5x forms-spinner-desktop"></i>

    <div id="partner-search-filters" data-search-path="<%= filter_forms_partner_index_path %>">
      <%= form_tag filter_forms_partner_index_path, :method => 'get' do %>
        <div class="row vertical-padding">
          <div class="col-xs-5 form-label-responsive">
            <%= label_tag :name, 'Name' %>
          </div>
          <div class="col-xs-7 col-sm-left-padding">
            <%= autocomplete_field_tag :name, params[:name],
              autocomplete_wufoo_partner_form_name_forms_partner_index_path,
              update_elements: {},
              placeholder: "Bob Smith",
              class:'form-control' %>
          </div>
        </div>

        <div class="row vertical-padding">
          <div class="col-xs-5 form-label-responsive">
            <%= label_tag(:address_street_address, "Street Address") %>
          </div>
          <div class="col-xs-7 col-sm-left-padding">
            <%= autocomplete_field_tag :address_street_address, params[:address_street_address],
              autocomplete_wufoo_partner_form_address_street_address_forms_partner_index_path,
              update_elements: {},
              placeholder: "Bob Smith",
              class:'form-control' %>
          </div>
        </div>

      <% end %>
    </div>
  </div>
  <div class="col-xs-12 col-md-4">

    <div class="row vertical-padding">
      <div class="col-xs-5 form-label-responsive">
        <%= label_tag(:move_in_date) %>
      </div>
      <div class="col-xs-7 col-sm-left-padding">
        <div class='input-group date datepicker'>
          <%= text_field_tag :move_in_date, params[:move_in_date],
            placeholder: "date", class:"form-control", size:30 %>
          <label class="input-group-addon btn" for="date">
            <span class="fa fa-calendar open-datepicker"></span>
          </label>
        </div>
      </div>
    </div>

    <div class="row vertical-padding">
      <div class="col-xs-5 form-label-responsive">
        <%= label_tag(:submitted_date) %>
      </div>
      <div class="col-xs-7 col-sm-left-padding">
        <div class='input-group date datepicker'>
          <%= text_field_tag :submitted_date, params[:submitted_date],
            placeholder: "date", class:"form-control", size:30 %>
          <label class="input-group-addon btn" for="date">
            <span class="fa fa-calendar open-datepicker"></span>
          </label>
        </div>
      </div>
    </div>

  </div>

  <div class="col-xs-12 col-md-4">

    <div class="row vertical-padding">
      <div class="col-xs-5 form-label-responsive">
        <%= label_tag(:renovated) %>
      </div>
      <div class="col-xs-7 col-sm-left-padding">
        <%= select_tag(:renovated,
          options_for_select(['Yes', 'No'],
            [params[:renovated].blank? ? 'Active' : params[:renovated]]),
          {class: "form-control",
          prompt: "Any"}) %>
      </div>
    </div>

    <div class="row vertical-padding">
      <div class="col-xs-5 form-label-responsive">
        <%= label_tag(:number_of_bedrooms, 'Bedrooms') %>
      </div>
      <div class="col-xs-7 col-sm-left-padding">
        <%= select_tag(:number_of_bedrooms,
          options_for_select(['Studio', '1 Bed', '2 Beds', '3 Beds', '4 Beds', '5 Beds', '6+ Beds'],
            [params[:number_of_bedrooms]]),
          {class: "form-control",
          prompt: "Any"}) %>
      </div>
    </div>
  </div>

</div>

<hr />
<%= form_tag forms_partner_index_path do %>
<br />
<div class="row">
  <div class="col-md-6">
      <!-- will be a dropdown of either print pdf or email -->
      <div class="dropdown selected-listings">
        <button class="btn btn-warning btn-sm dropdown-toggle disabled" id="selected-listings-dropdown" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" role="menu">
          0 Selected Entries
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu selected-listings-menu" aria-labelledby="selected-listings-dropdown">
          <li role="presentation"><a class="list-item-sm-padding" data-action="mark-read" role="menuitem" tabindex="-1">
            <i class="fa fa-fw fa-file-text"></i> Mark Read</a></li>

          <li role="presentation"><a class="list-item-sm-padding" id="deleteMultiple" role="menuitem" tabindex="-1"
            data-toggle="modal" data-target="#entryDeleteMultipleModal">
            <i class="fa fa-fw fa-envelope"></i> Delete</a></li>

          <li role="presentation"><a class="list-item-sm-padding" id="emailListings" role="menuitem" tabindex="-1" data-toggle="modal" data-target="#emailModal">
            <i class="fa fa-fw fa-envelope"></i> Email</a></li>

          <li role="presentation"><a class="list-item-sm-padding" data-action="PDF" role="menuitem" tabindex="-1">
            <i class="fa fa-fw fa-file-text"></i> PDF</a></li>

          <li role="presentation"><a class="list-item-sm-padding" data-action="CSV" role="menuitem" tabindex="-1">
            <i class="fa fa-fw fa-list"></i> CSV</a></li>
        </ul>
      </div>

    <span class="totals">
      &nbsp;&nbsp;<%= @entries.total_count %> Entries found
    </span>
  </div>

  <div class="col-md-6">
    <div class="form-label-responsive">
      <%= render partial: 'shared/pagination', locals: {models: @entries} %>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <div class="table-responsive">
      <table class="table table-striped table-hover table-condensed">
        <thead>
          <tr>
            <th style="min-width: 45px;">
              <!-- checkboxes -->
              <i data-action="selectAllUnits" class="select-all-listings fa fa-square-o fa-lg"></i>
            </th>
            <th data-sort="name" class="th-sortable">Name</th>
            <th>Phone</th>
            <th>Email</th>
            <th>Source</th>
            <th data-sort="address_street_address" class="th-sortable">Street Address</th>
            <th data-sort="number_of_bedrooms" class="th-sortable">Bedrooms</th>
            <th data-sort="renovated" class="th-sortable">Renovated</th>
            <th data-sort="move_in_date" class="th-sortable">Move In Date</th>

            <th data-sort="created_at" class="th-sortable">Submitted</th>
            <th data-sort="status">Status</th>
            <% if current_user.is_management? || current_user.is_listings_manager? %>
              <th colspan="1"></th>
            <% end %>
          </tr>
        </thead>

        <tbody class="partner_table_body">
          <%= render partial: 'forms/partner/entry',
          :collection => @entries, as: :entry %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<% end %><!-- form -->

<div class="row">
  <div class="col-md-12 form-label-responsive">
    <%= render partial: 'shared/pagination', locals: {models: @entries} %>
  </div>
</div>

<!-- Email Modal -->
<div class="modal fade modal-fullscreen" id="emailModal" tabindex="-1" role="dialog"
  aria-labelledby="emailModal" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">

        <%= form_tag(send_message_forms_partner_index_path, remote:true) do %>
        <div class="row vertical-padding">
          <div class="col-md-12">
            <%= label_tag "email_modal[recipients]", "Recipients", class: 'required' %>
            <i><small>Use commas to separate email addresses</small></i>
            <%= text_field_tag "email_modal[recipients]", nil, class: 'form-control', required: true %>
          </div>
        </div>

        <div class="row vertical-padding">
          <div class="col-md-12">
            <%= label_tag "email_modal[title]", "Title", class: 'required' %>
            <%= text_field_tag "email_modal[title]", "Thank you for contacting us!", class: 'form-control', required: true %>
          </div>
        </div>

        <div class="row vertical-padding">
          <div class="col-md-12">
            <%= label_tag "email_modal[message]", "Message" %>
            <%= text_area_tag "email_modal[message]", nil, class: 'form-control', rows: 8 %>
          </div>
        </div>

        <br />
        <div class="row vertical-padding">
          <div class="col-md-12">

          </div>
        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default horizontal-padding" data-dismiss="modal">Cancel</button>&nbsp;&nbsp;
        <%= submit_tag "Send Email", class:"btn btn-warning" %>
      </div>

      <% end %>

    </div>
  </div>
</div>

<%= render partial: 'forms/shared/modals' %>

</div>

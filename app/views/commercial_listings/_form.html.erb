<div id="commercial" data-runit-id="<%= @commercial_unit.id %>">

<!-- Nav tabs -->
<ul class="nav nav-tabs" role="tablist">
  <li role="presentation" class="active"><a href="#basic-info" aria-controls="basic-info" role="tab" data-toggle="tab">Basic Info</a></li>
  <li role="photos"><a href="#photos" aria-controls="photos" role="tab" data-toggle="tab">Photos</a></li>
</ul>

<div class="panel panel-default">
  <div class="panel-body no-top-padding">

  <div class="tab-content">
    <!-- ******************** second tabpanel - photos ******************** -->
    <div role="tabpanel" class="tab-pane fade" id="photos">
      
      <% if @commercial_unit.id %>

        <br />
        <%= form_for(@commercial_unit, :url => commercial_listing_unit_images_path(@commercial_unit), 
          html: {multipart: true, class: "dropzone", id: "cunit-dropzone"}, method: :post) do |f| %>
          <div class="fallback">
            <%= f.file_field :file %><br>
            <%= f.submit "Upload" %>
          </div>
        <% end %>
      
        <br />
        <div class="row">
          <div class="col-md-12">
            <p><strong>Edit current photos (drag to reorder):</strong></p>
            <div class="images sortable">
              <% if @commercial_unit.unit.images.length > 0 %>
                <%= render 'images',  locals: { commercial_unit: @commercial_unit } %>
              <% else %>
                <p>(No files uploaded yet.)</p>
              <% end %>
            </div>
          </div>
        </div>

      <% else %>
        <br />
        <strong>Save the basic info first!</strong>
      <% end %>
      
    </div><!-- end tabpanel photos -->
    <!-- ******************** first tabpanel - basic info ********************-->
    <div role="tabpanel" class="tab-pane fade in active" id="basic-info">
      <%= form_for(@commercial_unit) do |f| %>
      <%= render :partial => 'shared/error_messages', 
        :locals => {:model => @commercial_unit} %>
        <div class="row">
          <div class="col-md-12 form-section-header">
            <h4>Listing Status</h4>
            <hr class="thin-line" />
          </div>
        </div>
        <br />

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <strong>Current Listing Status</strong>
          </div>
          <div class="col-md-8">
            <div class="field">
              <%= f.fields_for @commercial_unit.unit do |unit_form| %>
                <%= unit_form.radio_button :status, "active", checked: (@commercial_unit.unit.status == "active") %>
                <%= unit_form.label :status_active, "Active" %>&nbsp;&nbsp;&nbsp;
                <%= unit_form.radio_button :status, "off", checked: (@commercial_unit.unit.status == "off") %>
                <%= unit_form.label :status_off, "Off" %><br>
              <% end %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-12 form-section-header">
            <hr class="thin-line" />
            <h4>Property Type</h4>
            <hr class="thin-line" />
          </div>
        </div>
        <br />

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <strong>Property Type</strong>
          </div>
          <div class="col-md-3">
            <div class="field">
              <%= f.select(:property_type, 
                options_for_select(@property_types.collect {|b| [b.property_type]},
                [@commercial_unit.commercial_property_type ? @commercial_unit.commercial_property_type.property_type : '']), 
                {},
                {:size => 8,
                  class: 'form-control',
                  data: {
                  }
                }) %>
                <!-- "update-subtype-path": update_subtype_commercial_listing_path(@commercial_unit), --> 
            </div>
          </div>
          <div class="col-md-5">
            <div class="field">
              <!-- gets updated when property_type changes -->
              <%= render 'sub_types_select' %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <strong>Construction Status</strong>
          </div>
          <div class="col-md-8">
            <div class="field">
              <%= f.radio_button :construction_status, "existing", 
                checked: (@commercial_unit.construction_status == "existing") %>
              <%= f.label :construction_status_existing, "Existing" %>&nbsp;&nbsp;&nbsp;
              <%= f.radio_button :construction_status, "under_construction", 
                checked: (@commercial_unit.construction_status == "under_construction") %>
              <%= f.label :construction_status_under_construction, "Under Construction" %><br>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= f.label :build_to_suit %>
          </div>
          <div class="col-md-1">
            <div class="field">
              <%= f.check_box :build_to_suit, class: 'form-control', checked: @commercial_unit.build_to_suit %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-12 form-section-header">
            <hr class="thin-line" />
            <h4>Space Details</h4>
            <hr class="thin-line" />
          </div>
        </div>
        <br />

        <%= f.fields_for @commercial_unit.unit do |unit_form| %>
          <div class="row">
            <div class="col-md-4 form-label-responsive">
              <%= unit_form.label :building_id %>
            </div>
            <div class="col-md-8">
              <div class="field">
                <!-- TODO: turn this into an autocomplete field -->
                <%= unit_form.select(:building_id, 
                  options_for_select(current_user.company.buildings.collect {|b| [b.street_address, b.id]},
                    [@commercial_unit.unit.building ? @commercial_unit.unit.building.id : '']), 
                  {prompt: "Choose one..."},
                  class: 'form-control',
                  :include_blank => true) %>
              </div>
            </div>
          </div>
        
          <div class="row">
            <div class="col-md-4 form-label-responsive">
              <%= unit_form.label :building_unit, "Suite/Apt/Unit" %>
            </div>
            <div class="col-md-2">
              <div class="field">
                <%= unit_form.text_field :building_unit, class: 'form-control' %>
              </div>
            </div>
          </div>
        <% end %>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= f.label :floor, "Floor" %>
          </div>
          <div class="col-md-2">
            <div class="field">
              <%= f.text_field :floor, class: 'form-control', :required => true %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= f.label :sq_footage, 'Space Available (SF)' %>
          </div>
          <div class="col-md-2">
            <div class="field">
              <%= f.number_field :sq_footage, class: 'form-control', :required => true %>
            </div>
          </div>
        </div>
        
        <div class="row">
          <%= f.fields_for @commercial_unit.unit do |unit_form| %>
          <div class="col-md-4 form-label-responsive">
            <%= unit_form.label :rent, 'Rental rate' %>
          </div>
          <div class="col-md-2">
            <div class="field">
              <%= unit_form.number_field :rent, class: 'form-control', :required => true %>
              <!-- SF/YEAR SF/Month Amnt/Month Amt/Year -->
            </div>
          </div>
          <% end %>
          <div class="col-md-3">
            <div class="field">
              <%= f.check_box :rate_is_negotiable, checked: @commercial_unit.rate_is_negotiable %>&nbsp;
              <%= f.label :rate_is_negotiable %>
            </div>
          </div>
        </div>

        <%= f.fields_for @commercial_unit.unit do |unit_form| %>
        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= unit_form.label :available_by, 'Date available' %>
          </div>
          <div class="col-md-4">
            <div class="field">
              <div class='input-group date datepicker'>
                <%= unit_form.text_field :available_by, 
                  class:"form-control", placeholder: "Available" %>
                <label class="input-group-addon btn" for="date">
                  <span class="fa fa-calendar open-datepicker"></span>
                </label>
              </div>
            </div>
          </div>
        </div>
        <% end %>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= f.label :lease_type %>
          </div>
          <div class="col-md-4">
            <div class="field">
              <%= f.select :lease_type, 
                options_for_select(CommercialListing.lease_types.collect { |s| [s[0].humanize.titleize, s[0]] }, 
                  [@commercial_unit.lease_type]), 
                {prompt: "Choose one..."},
                :required => true,
                class: "form-control" %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            Sublease?
          </div>
          <div class="col-md-2">
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= f.label :minimum_divisible, 'Minimum Divisible (SF)' %>
          </div>
          <div class="col-md-2">
            <div class="field">
              <%= f.number_field :minimum_divisible, class: 'form-control', :required => true %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= f.label :maximum_contiguous, 'Maximum Contiguous (SF)' %>
          </div>
          <div class="col-md-2">
            <div class="field">
              <%= f.number_field :maximum_contiguous, class: 'form-control', :required => true %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= f.label :lease_term_months, 'Lease Term (Months)' %>
          </div>
          <div class="col-md-2">
            <div class="field">
              <%= f.number_field :lease_term_months, class: 'form-control', :required => true %> 
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= f.label :no_parking_spaces, '# Parking Spaces' %>
          </div>
          <div class="col-md-2">
            <div class="field">
              <%= f.number_field :no_parking_spaces, class: 'form-control', :required => true %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= f.label :pct_procurement_fee, 'Procurement Fee %' %>
          </div>
          <div class="col-md-2">
            <div class="field">
              <%= f.number_field :pct_procurement_fee, class: 'form-control', :required => true %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-12 form-section-header">
            <hr class="thin-line" />
            <h4>Property Info</h4>
            <hr class="thin-line" />
          </div>
        </div>
        <br />

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= f.label :property_description %>
          </div>
          <div class="col-md-8">
            <div class="field">
              <%= f.text_area :property_description, class: 'form-control', :required => true, rows: 5 %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= f.label :location_description %>
          </div>
          <div class="col-md-8">
            <div class="field">
              <%= f.text_area :location_description, class: 'form-control', :required => true, rows: 5 %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= f.label :building_size, 'Total Building Size (SF)' %>
          </div>
          <div class="col-md-2">
            <div class="field">
              
              <%= f.number_field :building_size, class: 'form-control', :required => true %>
            </div>
          </div>
        </div>
        
        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <%= f.label :total_lot_size, 'Total Lot Size' %>
          </div>
          <div class="col-md-2">
            <div class="field">
              <%= f.number_field :total_lot_size, class: 'form-control', :required => true %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-12"><hr />
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 form-label-responsive">
            <div class="actions">
              <%= f.submit 'Save Data', class:"btn btn-warning" %>
            </div>
          </div>
          
        </div>
      <% end %>
    </div>
  </div>





      </div><!-- end tabpanel home -->
    </div><!-- tab content -->

  </div><!-- panelbody -->
</div><!-- panel -->


</div>